Namespace(arch='vgg16', batchSize=4, cacheBatchSize=24, cachePath='./tmp', cacheRefreshRate=1000, ckpt='latest', dataPath='./data/', dataset='pittsburgh', evalEvery=1, fromscratch=False, lr=0.0001, lrGamma=0.5, lrStep=5, margin=0.1, mode='train', momentum=0.9, nEpochs=30, nGPU=1, nocuda=False, num_clusters=4, optim='SGD', patience=10, pooling='netvlad', resume='', runsPath='./runs/', savePath='checkpoints', seed=123, split='val', start_epoch=0, threads=8, vladv2=False, weightDecay=0.001)
===> Loading dataset(s)
====> Training query set: 1379
===> Evaluating on val set, query count: 169
===> Building model
===> Training model
===> Saving state to: ./runs/Jul14_09-50-59_vgg16_netvlad
====> Building Cache
Allocated:57.0234375MB
Cached:10882.0MB
==> Epoch[1](50/345): Loss: 0.1422
Allocated:111.06689453125MB
Cached:22614.0MB
==> Epoch[1](100/345): Loss: 0.0781
Allocated:111.06689453125MB
Cached:22614.0MB
==> Epoch[1](150/345): Loss: 0.0993
Allocated:111.06689453125MB
Cached:22614.0MB
====> Building Cache
Allocated:111.06640625MB
Cached:10954.0MB
==> Epoch[1](200/345): Loss: 0.1489
Allocated:111.06689453125MB
Cached:22684.0MB
==> Epoch[1](250/345): Loss: 0.0137
Allocated:111.06689453125MB
Cached:22684.0MB
==> Epoch[1](300/345): Loss: 0.0794
Allocated:111.06689453125MB
Cached:22684.0MB
===> Epoch 1 Complete: Avg. Loss: 0.1157
====> Extracting Features
====> Building faiss index
====> Calculating recall @ N
====> Recall@1: 0.1065
====> Recall@5: 0.4379
====> Recall@10: 0.6272
====> Recall@20: 0.7988
====> Building Cache
Allocated:111.06640625MB
Cached:10954.0MB
==> Epoch[2](50/345): Loss: 0.1010
Allocated:111.06689453125MB
Cached:22684.0MB
==> Epoch[2](100/345): Loss: 0.0612
Allocated:111.06689453125MB
Cached:22684.0MB
==> Epoch[2](150/345): Loss: 0.0685
Allocated:111.06689453125MB
Cached:22684.0MB
====> Building Cache
Allocated:111.06640625MB
Cached:10954.0MB
==> Epoch[2](200/345): Loss: 0.1126
Allocated:111.06689453125MB
Cached:22684.0MB
==> Epoch[2](250/345): Loss: 0.1723
Allocated:111.06689453125MB
Cached:22684.0MB
==> Epoch[2](300/345): Loss: 0.0541
Allocated:111.06689453125MB
Cached:22684.0MB
===> Epoch 2 Complete: Avg. Loss: 0.0752
====> Extracting Features
====> Building faiss index
====> Calculating recall @ N
====> Recall@1: 0.1361
====> Recall@5: 0.4852
====> Recall@10: 0.6746
====> Recall@20: 0.8757
====> Building Cache
Allocated:111.06640625MB
Cached:10954.0MB
==> Epoch[3](50/345): Loss: 0.0477
Allocated:111.06689453125MB
Cached:22684.0MB
==> Epoch[3](100/345): Loss: 0.0655
Allocated:111.06689453125MB
Cached:22684.0MB
==> Epoch[3](150/345): Loss: 0.0486
Allocated:111.06689453125MB
Cached:22684.0MB
====> Building Cache
Allocated:111.06640625MB
Cached:10954.0MB
==> Epoch[3](200/345): Loss: 0.0309
Allocated:111.06689453125MB
Cached:22684.0MB
==> Epoch[3](250/345): Loss: 0.0513
Allocated:111.06689453125MB
Cached:22684.0MB
==> Epoch[3](300/345): Loss: 0.0480
Allocated:111.06689453125MB
Cached:22684.0MB
===> Epoch 3 Complete: Avg. Loss: 0.0566
====> Extracting Features
====> Building faiss index
====> Calculating recall @ N
====> Recall@1: 0.1183
====> Recall@5: 0.4675
====> Recall@10: 0.6686
====> Recall@20: 0.8994
====> Building Cache
Allocated:111.06640625MB
Cached:10954.0MB
==> Epoch[4](50/345): Loss: 0.0536
Allocated:111.06689453125MB
Cached:22684.0MB
==> Epoch[4](100/345): Loss: 0.0518
Allocated:111.06689453125MB
Cached:22684.0MB
==> Epoch[4](150/345): Loss: 0.0407
Allocated:111.06689453125MB
Cached:22684.0MB
====> Building Cache
Allocated:111.06640625MB
Cached:10954.0MB
==> Epoch[4](200/345): Loss: 0.0604
Allocated:111.06689453125MB
Cached:22684.0MB
==> Epoch[4](250/345): Loss: 0.0366
Allocated:111.06689453125MB
Cached:22684.0MB
==> Epoch[4](300/345): Loss: 0.0228
Allocated:111.06689453125MB
Cached:22684.0MB
===> Epoch 4 Complete: Avg. Loss: 0.0461
====> Extracting Features
====> Building faiss index
====> Calculating recall @ N
====> Recall@1: 0.1243
====> Recall@5: 0.4793
====> Recall@10: 0.6805
====> Recall@20: 0.9053
====> Building Cache
Allocated:111.06640625MB
Cached:10954.0MB
==> Epoch[5](50/345): Loss: 0.0495
Allocated:111.06689453125MB
Cached:22684.0MB
==> Epoch[5](100/345): Loss: 0.0342
Allocated:111.06689453125MB
Cached:22684.0MB
==> Epoch[5](150/345): Loss: 0.0466
Allocated:111.06689453125MB
Cached:22684.0MB
====> Building Cache
Allocated:111.06640625MB
Cached:10954.0MB
==> Epoch[5](200/345): Loss: 0.0182
Allocated:111.06689453125MB
Cached:22684.0MB
==> Epoch[5](250/345): Loss: 0.0185
Allocated:111.06689453125MB
Cached:22684.0MB
==> Epoch[5](300/345): Loss: 0.0188
Allocated:111.06689453125MB
Cached:22684.0MB
===> Epoch 5 Complete: Avg. Loss: 0.0397
====> Extracting Features
====> Building faiss index
====> Calculating recall @ N
====> Recall@1: 0.1302
====> Recall@5: 0.4675
====> Recall@10: 0.6982
====> Recall@20: 0.8994
====> Building Cache
Allocated:111.06640625MB
Cached:10954.0MB
==> Epoch[6](50/345): Loss: 0.0262
Allocated:111.06689453125MB
Cached:22684.0MB
==> Epoch[6](100/345): Loss: 0.0288
Allocated:111.06689453125MB
Cached:22684.0MB
==> Epoch[6](150/345): Loss: 0.0400
Allocated:111.06689453125MB
Cached:22684.0MB
====> Building Cache
Allocated:111.06640625MB
Cached:10954.0MB
==> Epoch[6](200/345): Loss: 0.0321
Allocated:111.06689453125MB
Cached:22684.0MB
==> Epoch[6](250/345): Loss: 0.0054
Allocated:111.06689453125MB
Cached:22684.0MB
==> Epoch[6](300/345): Loss: 0.0322
Allocated:111.06689453125MB
Cached:22684.0MB
===> Epoch 6 Complete: Avg. Loss: 0.0360
====> Extracting Features
====> Building faiss index
====> Calculating recall @ N
====> Recall@1: 0.1243
====> Recall@5: 0.4734
====> Recall@10: 0.6923
====> Recall@20: 0.8935
====> Building Cache
Allocated:111.06640625MB
Cached:10954.0MB
==> Epoch[7](50/345): Loss: 0.0500
Allocated:111.06689453125MB
Cached:22684.0MB
==> Epoch[7](100/345): Loss: 0.0261
Allocated:111.06689453125MB
Cached:22684.0MB
==> Epoch[7](150/345): Loss: 0.0355
Allocated:111.06689453125MB
Cached:22684.0MB
====> Building Cache
Allocated:111.06640625MB
Cached:10954.0MB
==> Epoch[7](200/345): Loss: 0.0316
Allocated:111.06689453125MB
Cached:22684.0MB
==> Epoch[7](250/345): Loss: 0.0281
Allocated:111.06689453125MB
Cached:22684.0MB
==> Epoch[7](300/345): Loss: 0.1050
Allocated:111.06689453125MB
Cached:22684.0MB
===> Epoch 7 Complete: Avg. Loss: 0.0334
====> Extracting Features
====> Building faiss index
====> Calculating recall @ N
====> Recall@1: 0.1361
====> Recall@5: 0.4675
====> Recall@10: 0.7041
====> Recall@20: 0.9172
====> Building Cache
Allocated:111.06640625MB
Cached:10954.0MB
==> Epoch[8](50/345): Loss: 0.0174
Allocated:111.06689453125MB
Cached:22684.0MB
==> Epoch[8](100/345): Loss: 0.0267
Allocated:111.06689453125MB
Cached:22684.0MB
==> Epoch[8](150/345): Loss: 0.0411
Allocated:111.06689453125MB
Cached:22684.0MB
====> Building Cache
Allocated:111.06640625MB
Cached:10954.0MB
==> Epoch[8](200/345): Loss: 0.0426
Allocated:111.06689453125MB
Cached:22684.0MB
